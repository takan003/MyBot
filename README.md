# Google Apps Script 聊天機器人

這是一個簡單好用的 **Google Apps Script** (GAS) 聊天機器人，結合 Google 試算表管理資料，提供網頁介面讓用戶輕鬆互動。支援指令查詢、關鍵字回應、權限控制和主題切換等功能。本指南專為 Google Apps Script 初學者的中文用戶設計，幫助您快速上手。

## 功能特色

- **網頁介面**：使用 Bootstrap 5.3.2，支援淺色和深色主題。
- **指令系統**：輸入特定指令（如 `/指令`、`/幫助`）觸發功能。
- **關鍵字回應**：根據試算表中的關鍵字回應用戶問題。
- **權限管理**：限制某些回應僅特定用戶可見。
- **多樣回應**：支援文字、圖片、隨機回應及外部資料。
- **手機友好**：適配手機和平板，操作方便。
- **易於自訂**：透過試算表調整設定和資料。

## 您的準備

- 了解 **Google Apps Script** 和 **Google 試算表** 基礎。
- 擁有 **Google 帳戶**，可使用 Google 雲端硬碟和試算表。
- 略懂 HTML、CSS、JavaScript（若需自訂介面，非必要）。

## 回應方式說明

聊天機器人支援以下五種回應方式，設定於試算表「數據庫」工作表的「回應方式」欄位：

1. **一般**：直接顯示指定的文字回應，或引用其他指令（以指令符號開頭）。
2. **亂數**：從多個回應中隨機挑選一個（用逗號分隔）。
3. **圖片**：顯示單張圖片（隨機選一張，若有多張），可附圖片說明。
4. **圖片全**：顯示所有指定圖片（用逗號分隔），每張可附說明。
5. **外掛**：將用戶輸入傳遞至外部試算表處理，適用進階功能。

## 設定步驟

### 步驟 1：複製試算表

1. 點擊以下 Google 雲端硬碟連結，建立試算表副本：\
   [[Google 雲端硬碟連結](https://drive.google.com/drive/folders/1AezuyEmNpQ8PkqJH2Ec3jVe4Xt5E31N8)]
2. 資料夾包含以下試算表：
   - **我的聊天機器人\_內含主程式\_自由取名.gsheet**：主程式試算表。
   - **成員名冊\_內含程式\_自由取名.gsheet**：成員名冊，含選單功能。
   - **數據庫(基本)\_一定要有\_自由取名.gsheet**：基本資料庫。
   - **數據庫(外掛)\_自由取名.gsheet**：外部資料庫。
   - **問題收集試算表\_自由取名.gsheet**：收集未匹配問題。
3. 範例圖檔可用於設定機器人圖像。

### 步驟 2：設定 Google 試算表

1. **主聊天機器人試算表**：

   - 複製 `我的聊天機器人_內含主程式_自由取名.gsheet` 到您的 Google 雲端硬碟。
   - 重新命名（例如「我的聊天機器人」）。
   - 確認「設定」工作表包含以下欄位：
     - **程式名稱**：機器人名稱（例如「我的聊天機器人」）。
     - **機器人圖像連結**：機器人圖片的 Google 雲端硬碟共用連結，權限至少為「知道連結的任何人：檢視者」。
     - **機器人介紹**：機器人介紹文字。
     - **指令特殊符號**：指令前綴（預設：`/`）。
     - **基本數據庫連結**：基本資料庫試算表的共用連結。
     - **成員名冊連結**：成員名冊試算表的共用連結。
     - **問題收集試算表連結**：問題收集試算表的共用連結。
     - **幫助說明**：`/幫助` 指令的說明文字。
     - **不會的問題如何回**：未匹配問題的回應（每行一個）。
     - **贊助廣告開關**：設為「啟用」顯示廣告，留空關閉。
     - **自訂版權宣告**：自訂版權文字。

2. **成員名冊試算表**：

   - 複製 `成員名冊_內含程式_自由取名.gsheet` 到您的 Google 雲端硬碟。
   - 重新命名（例如「成員名冊」）。
   - 確認「成員名冊」工作表包含：
     - **電子信箱**：用戶電子郵件。
     - **姓名**：用戶姓名。
     - **權限群組**、**組織單位**、**團體群組**：權限設定。

3. **數據庫(基本)**：

   - 複製 `數據庫(基本)_一定要有_自由取名.gsheet` 或新建試算表。
   - 建立「數據庫」工作表，欄位如下：
     - **關鍵字**：用逗號分隔的關鍵字，匹配用戶輸入。
     - **回應內容**：回應內容（文字、圖片網址等）。
     - **回應方式**：回應類型（`一般`、`亂數`、`圖片`、`圖片全`、`外掛`）。
     - **前綴詞**：回應前綴（逗號分隔）。
     - **後綴詞**：回應後綴（逗號分隔）。
     - **指令說明**：指令說明（顯示於 `/指令`）。
     - **權限群組**、**組織單位**、**團體群組**：權限設定。
   - 分享試算表，將共用連結填入主試算表「設定」的「基本數據庫連結」。

4. **數據庫(外掛)**：

   - 複製 `數據庫(外掛)_自由取名.gsheet` 或新建試算表。
   - 建立「數據庫」工作表，結構與主試算表的「數據庫」相同。

5. **問題收集試算表**：

   - 複製 `問題收集試算表_自由取名.gsheet` 或新建試算表。
   - 建立「數據庫」工作表，包含「問題」欄位及「提問者」欄位。
   - 分享試算表，將共用連結填入主試算表「設定」的「問題收集試算表連結」。

### 步驟 3：部署網頁應用程式

1. 開啟主聊天機器人試算表（例如「我的聊天機器人」）。
2. 點擊 **功能選單中的擴充功能 &gt; Apps Script**。
3. 在程式碼編輯器中，點擊 **部署 &gt; 新增部署**。
4. 選擇 **網頁應用程式**。
5. 設定部署：
   - **描述**：例如「聊天機器人」。
   - **執行身分**：選擇「我」（您的 Google 帳戶）。
   - **存取權限**：建議選「任何人」，讓外部用戶也可以使用。
6. 點擊 **部署**，複製網頁應用程式 URL。
7. 分享 URL 給用戶，或在瀏覽器中開啟使用。

### 步驟 4：設定成員名冊進階功能

- 成員名冊試算表的功能選單會新增「進階功能」，用於讀取共用 Google 雲端硬碟資料夾中的所有檔案資訊，作為檔案管理小幫手。
- 需提供共用資料夾連結並確保試算表有存取權限。

## 使用方法

1. 在瀏覽器開啟網頁應用程式 URL。
2. 介面包含：
   - **主題切換**（右上角）：選擇淺色或深色主題。
   - **機器人圖像與介紹**：手機上點擊圖像顯示介紹。
   - **輸入框**：底部輸入訊息。
3. 與機器人互動：
   - **指令**：\
     使用指令格式（例如 `/指令`）可精準觸發功能，避免關鍵字重複導致無法提供指定回應。
     - `/指令`：顯示所有指令。
     - `/幫助`：查看幫助說明。
     - `/贊助`：顯示贊助資訊。
     - `/帳號`：顯示您的電子郵件。
     - `/查詢 [項目]`：查詢個人資料（例如 `/查詢 姓名`）。
     - `/查詢 全`：列出所有個人資料。
   - **關鍵字**：輸入資料庫中的關鍵字（例如「你好」）獲取回應。
4. 在「數據庫」工作表中編輯關鍵字和回應。
5. 在成員名冊試算表管理用戶權限和資料。

## 自訂方式

- **更改外觀**：在「設定」工作表更新「機器人圖像連結」和「機器人介紹」。
- **修改回應**：在「數據庫」工作表新增或編輯關鍵字與回應。
- **設定權限**：在成員名冊試算表更新用戶權限。
- **調整介面**：修改 `style.html`（樣式）或 `index.html`（結構）。
- **新增指令**：編輯 `codeResponse.js` 增加指令功能。

## 問題排查

- **網頁無法開啟**：檢查部署的存取權限（建議選「任何人」）。
- **指令無反應**：確認「設定」中的「指令特殊符號」（例如 `/`）並正確使用。
- **權限錯誤**：確認成員名冊連結正確，且用戶電子郵件在「成員名冊」中。
- **資料庫問題**：檢查資料庫試算表連結和「數據庫」工作表是否存在。
- **手機顯示問題**：測試介面，必要時調整 `style.html` 的樣式。

## 注意事項

- 確保所有試算表共用連結有效且可存取。
- 成員名冊的「進階功能」需搭配共用資料夾。
- 預設包含廣告（可透過「贊助廣告開關」關閉）。
- 進階自訂可參考 `codeResponse.js`（回應邏輯）和 `functions.html`（前端功能）。

## 授權

本專案採用 MIT 授權，詳情請見 LICENSE。

## 致謝

由 Chang, Chia-Cheng（張家誠）開發。\
透過 贊助連結 支持本專案，或訪問 GAS Station。

---

祝您輕鬆打造專屬聊天機器人！🚀

## 附錄：程式碼結構（進階用戶）

若您熟悉程式碼並想深入自訂，可參考以下檔案（已內嵌於主試算表的 Apps Script 中）：

- `index.html`：網頁介面結構。
- `style.html`：CSS 樣式設定。
- `functions.html`：前端 JavaScript 功能。
- `base.js`：版權與廣告設定。
- `code.js`：核心後端邏輯。
- `codeResponse.js`：處理用戶輸入與回應。
- `codeLanguage.js`：中文文本預處理。

**檢查方式**：

1. 開啟主試算表。
2. 點擊 **功能選單中的擴充功能 &gt; Apps Script**。
3. 查看或編輯程式碼檔案。# MyBot
藉著Google Apps Script，讓你輕鬆地架設一個屬於自己的官方聊天機器人小幫手。
